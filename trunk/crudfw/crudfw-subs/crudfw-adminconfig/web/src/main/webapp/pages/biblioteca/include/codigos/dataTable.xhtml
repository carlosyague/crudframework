<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
	xmlns:librae="http://www.librae.org/jsf/facelets">

<head>
    <script type="text/javascript">
	function obtenerValoresSeleccionados(plantillaId){
		i=0;
		parar=false;
		$('bibliotecaForm:idValoresSeleccionados').value="";
		while (!parar){
		    id=plantillaId.replace("x", i);
		    elem=document.getElementById(id);
		    if (elem!=null){
		       $('bibliotecaForm:idValoresSeleccionados').value+=$F(id)+":"
		    }
		    else{
		       parar=true;
		    }
		    i=i+1;
		}
	}


	function cargarValoresSeleccionados(plantillaId){
		valores=$F('bibliotecaForm:idValoresSeleccionados');
		if (valores!=""){
		    tokens=valores.split(':');
		    for (i=0; i!=tokens.length; i++){
		        valor=tokens[i];
			if (valor!=""){
			   id=plantillaId.replace("x", i);
			   elem=document.getElementById(id);
			   if (elem!=null){
			      elem.value=valor;
 		           }
			}
		    }

		}

	}
    </script>
</head>

    <librae:listado id="codigos" var="codigo" value="#{bean.listado}" sortColumn="#{bean.sortColumn}"
		sortAscending="#{bean.ascending}" styleClass="listado"
		headerClass="standardTable_Header" rowClasses="impar,par">

	<t:column>
		<f:facet name="header">
			<t:commandSortHeader columnName="codigo.codigo" arrow="true">
				<a4j:commandLink reRender="codigos, paginacion" value="#{msg['codigo.codigo']}">
					<a4j:actionparam name="sortColumn" value="codigo" assignTo="#{bean.sortColumn}"/>
					<a4j:actionparam name="ascending"  value="#{!bean.ascending}" assignTo="#{bean.ascending}" />
				</a4j:commandLink>
			</t:commandSortHeader>
		</f:facet>
		<h:outputText value="#{codigo.codigo.codigo}" escape="true"/>
	</t:column>
	<t:column>
		<f:facet name="header">
			<h:outputText value="Valor" escape="true"/>
		</f:facet>

		<t:saveState id="saveValores" value="#{bibliotecaFormAction.form.valores}" />
		<h:selectOneMenu id="valores" onchange="obtenerValoresSeleccionados('bibliotecaForm:codigos:x:valores');" disabled="#{bibliotecaFormAction.form.readMode}">
			<f:selectItem itemValue="0" itemLabel="#{common['select.seleccione']}"/>
			<f:selectItems value="#{codigo.valores}" />
		</h:selectOneMenu>
	</t:column>
</librae:listado>

<h:inputHidden id="idValoresSeleccionados" value="#{bibliotecaFormAction.form.idValoresSeleccionados}"/>
<head>
 <script type="text/javascript">
     cargarValoresSeleccionados('bibliotecaForm:codigos:x:valores');
 </script>
</head>
</html>