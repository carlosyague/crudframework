<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
	xmlns:s="http://myfaces.apache.org/sandbox"
	xmlns:librae="http://www.librae.org/jsf/facelets">

<ui:composition template="/templates/defaultTemplate.xhtml">
	<ui:define name="title">#{msg['usuario.crear.title']}</ui:define>
	<ui:define name="body.id">usuarioFormAction</ui:define>
	<ui:define name="body">
		<f:view>
			<h:outputText value="#{usuarioFormAction.init}" />
			<h:form id="usuarioFormAction">

				<librae:breadCrumb />

				<t:saveState id="saveCreacion"
					value="#{usuarioFormAction.usuarioForm.creacion}" />
				<t:saveState id="saveCreacionBaja"
					value="#{usuarioFormAction.usuarioForm.activo}" />
				<t:panelGrid columns="1" styleClass="ruta"
					columnClasses="path,fechahora" cellpadding="0" cellspacing="0"
					border="0" rendered="#{!usuarioFormAction.usuarioForm.creacion}">
					<h:panelGroup>
						<t:panelGroup visibleOnUserRole="ADM_Desactivar_Usuario">
							<h:outputLink value="#" id="delete" styleClass="btn_barra" rendered="#{usuarioFormAction.usuarioForm.activo}"
									title="#{msg['usuario.button.desactivar']}" onclick="dialogo1Var.show();">
								<strong><h:outputText value="#{msg['usuario.button.desactivar']}" /></strong>
							</h:outputLink>
						</t:panelGroup>
						<t:commandLink action="#{usuarioFormAction.activar}"
							id="activar" styleClass="btn_barra" rendered="#{!usuarioFormAction.usuarioForm.activo}"
							title="#{msg['usuario.button.activar']}" visibleOnUserRole="ADM_Activar_Usuario">
							<span><h:outputText value="#{msg['usuario.button.activar']}" /></span>
						</t:commandLink>
					</h:panelGroup>
				</t:panelGrid>

				<t:div styleClass="contenido">
					<librae:tabbedPage tabs="#{usuarioFormAction.usuarioForm.tabGroup}"
						subTabs="#{usuarioFormAction.usuarioForm.subTabGroup}">
						<librae:tab binding="#{usuarioFormAction.usuarioForm.tabUsuario}">
							<ui:include src="/pages/usuario/include/usuario.xhtml">
								<ui:param name="usuarioFormAction" value="#{usuarioFormAction}" />
							</ui:include>
						</librae:tab>

						<librae:tab binding="#{usuarioFormAction.usuarioForm.tabAsignar}">
							<ui:include src="/pages/usuario/include/roles.xhtml">
								<ui:param name="asignarPerfilesUsuarioAction" value="#{asignarPerfilesUsuarioAction}" />
							</ui:include>
						</librae:tab>
					</librae:tabbedPage>
				</t:div>

				<t:div id="divConfirmacionBorrar" style="display: none;">
					<s:modalDialog  dialogId="dialogo2"  dialogVar="dialogo1Var"
						      dialogAttr="bgColor='white' bgOpacity='0.5' toggle='fade' toggleDuration='50'"
						      hiderIds="btnCerrar">
					        <t:panelGrid border="0" columns="1" styleClass="ventanaEmergente">
						    	<t:outputText id="msg"  value="#{msg['confirmacion.usuario']}" style="text-align:center;"/>
						    	<t:panelGroup>
						        	<t:panelGrid border="0" columns="2">
								        <t:commandLink action="#{usuarioFormAction.desactivar}" id="editD" immediate="true" styleClass="btn_barra">
											<t:htmlTag value="span"><h:outputText value="#{msg['usuario.button.desactivar']}" /></t:htmlTag>
										</t:commandLink>
								        <t:commandButton id="btnCerrar" forceId="true" onclick="dialogo1Var.hide();" styleClass="btn_barra_cerrar" value="#{common['button.cancel']}"/>
						        	</t:panelGrid>
					        	</t:panelGroup>
					        </t:panelGrid>
					</s:modalDialog>
				</t:div>
			</h:form>

			<!-- WINDOW MESSAGES -->
			<librae:windowMessages bean="#{usuarioFormAction}" borrar="true" />

		</f:view>
	</ui:define>
</ui:composition>
</html>
