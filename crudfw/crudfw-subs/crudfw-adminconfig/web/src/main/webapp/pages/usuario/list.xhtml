<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
	xmlns:librae="http://www.librae.org/jsf/facelets">

<ui:composition template="/templates/defaultTemplate.xhtml">
	<ui:define name="title">#{msg['usuarioSearch.title']}</ui:define>
	<ui:define name="body.id">usuarioListAction</ui:define>
	<ui:define name="body">
		<f:view>
			<script type="text/javascript">
				//<![CDATA[

				function limpiarSeleccionados () {
    				$('uF:codigoBiblioteca').value='';
    			}
    			//]]>
    		</script>

			<h:form id="uF" onsubmit="$('uF:buscar').focus();">
			      <head>
			  			<script type="text/javascript">
							Event.observe(document, 'keydown', loading_intro_usuario);
							function loading_intro_usuario(event) {
								loading_intro(event, 'uF', 'uF:buscar');
							}
						</script>
				  </head>

				<!-- BREADCRUMB -->
				<librae:executeMethod getter="#{breadCrumbAction.limpiarPath}" />
				<librae:breadCrumbFavoritos favoritoBean="#{menuAction}" />

				<librae:executeMethod getter="#{usuarioListAction.init}" id="init"/>

				<!-- CONTENIDO -->
				<t:div styleClass="contenido">

					<librae:tabbedPage tabs="#{usuarioListAction.form.tabGroup}"
						subTabs="#{usuarioListAction.form.subTabGroup}">
						<librae:tab binding="#{usuarioListAction.form.tabBuscarUsuario}">

							<t:div styleClass="cuadro">
								<t:div styleClass="cuadro02">
									<t:panelGrid columns="8" cellpadding="0" cellspacing="0" border="0" width="100%"
										headerClass="titular" footerClass="esq02" columnClasses="anchura5, anchura15, anchura10, anchura20, anchura15, anchura15, anchura5, anchura15">
										<f:facet name="header">
											<h:outputText value="#{msg['usuarioSearch.cuadro']}" />
										</f:facet>

										<h:outputLabel for="tipoIdentificacion"
											value="#{msg['usuarioSearch.criteria.identificacion']}" />
										<t:panelGroup colspan="3">
											<h:selectOneMenu id="tipoIdentificacion"
												value="#{usuarioListAction.form.tipoIdentificacion}">
												<f:selectItem itemValue="0"
													itemLabel="#{common['select.seleccione']}" />
												<f:selectItems value="#{comboAction.tiposIdentificacion}" />
											</h:selectOneMenu>
										</t:panelGroup>
										<h:outputLabel for="numeroIdentificacion"
											value="#{msg['usuarioSearch.criteria.numeroIdentificacion']}" />
										<t:panelGroup colspan="3">
											<h:inputText styleClass="text medium"
												id="numeroIdentificacion"
												value="#{usuarioListAction.form.numeroIdentificacion}"
												maxlength="255" />
										</t:panelGroup>
										<h:outputLabel for="usuario"
											value="#{msg['usuarioSearch.criteria.usuario']}" />
										<t:panelGroup colspan="3">
											<h:inputText styleClass="text medium" id="usuario"
												value="#{usuarioListAction.form.usuario}" required="false"
												maxlength="255" />
											<h:outputLink onclick="$('uF:usuario').value=$F('uF:codigoUsuario');" id="recuperarContextoUsuario" value="#">
												<h:graphicImage border="0" value="/images/ico_recuperar.gif" alt="#{common['button.contexto']}" title="#{common['button.contexto']}"/>
											</h:outputLink>
										</t:panelGroup>

										<h:outputLabel for="estadoUsuario"
											value="#{msg['usuarioSearch.criteria.estado']}" />
										<t:panelGroup colspan="3">
											<h:selectOneMenu id="estadoUsuario"
												value="#{usuarioListAction.form.estadoUsuario}">
												<f:selectItems value="#{comboAction.estadosUsuario}" />
											</h:selectOneMenu>
										</t:panelGroup>
										<h:outputLabel for="fechaAltaGrid"
												value=" #{msg['usuarioSearch.criteria.fechaAlta']}" />
										<t:panelGroup colspan="7">
											<h:outputLabel value=" #{common['common.desde']} " style="vertical-align:top !important"/>
											<t:inputCalendar id="fechaAltaDesdeCriteria"
												value="#{usuarioListAction.form.fechaAltaDesdeCriteria}"
												renderAsPopup="true" popupDateFormat="dd/MM/yyyy"
												renderPopupButtonAsImage="true"
												popupTodayString="#{common['common.calendar.hoyEs']}"
												popupWeekString="#{common['common.calendar.wK']}"
												popupButtonImageUrl="../../images/calendar_icon.gif"
												disabled="false" styleClass="dateDisabled" popupButtonStyle="margin:1px"/>
											<h:graphicImage border="0" value="/images/icon_limpiar.gif"
												alt="#{msg['usuarioSearch.criteria.fechaAlta']}"
												onclick="$('uF:fechaAltaDesdeCriteria').value=''" />
											<script type="text/javascript">
												$('uF:fechaAltaDesdeCriteria').disabled=true;
											</script>

											<h:outputLabel value=" #{common['common.hasta']} "/>
											<t:inputCalendar id="fechaAltaHastaCriteria"
												value="#{usuarioListAction.form.fechaAltaHastaCriteria}"
												renderAsPopup="true" popupDateFormat="dd/MM/yyyy"
												renderPopupButtonAsImage="true"
												popupTodayString="#{common['common.calendar.hoyEs']}"
												popupWeekString="#{common['common.calendar.wK']}"
												popupButtonImageUrl="../../images/calendar_icon.gif"
												disabled="false" styleClass="dateDisabled" popupButtonStyle="margin:1px"/>
											<h:graphicImage border="0" value="/images/icon_limpiar.gif"
												alt="#{msg['usuarioSearch.criteria.fechaAlta']}"
												onclick="$('uF:fechaAltaHastaCriteria').value=''" />
											<script type="text/javascript">
												$('uF:fechaAltaHastaCriteria').disabled=true;
											</script>
										</t:panelGroup>

										<h:outputLabel for="fechaBajaDesdeCriteria"
											value="#{msg['usuarioSearch.criteria.fechaBaja']}" />
										<t:panelGroup colspan="7">
											<h:outputLabel value=" #{common['common.desde']} "/>
											<t:inputCalendar id="fechaBajaDesdeCriteria"
												value="#{usuarioListAction.form.fechaBajaDesdeCriteria}"
												renderAsPopup="true" popupDateFormat="dd/MM/yyyy"
												renderPopupButtonAsImage="true"
												popupTodayString="#{common['common.calendar.hoyEs']}"
												popupWeekString="#{common['common.calendar.wK']}"
												popupButtonImageUrl="../../images/calendar_icon.gif"
												disabled="false" styleClass="dateDisabled" popupButtonStyle="margin:1px"/>
											<h:graphicImage border="0" value="/images/icon_limpiar.gif"
												alt="#{msg['usuarioSearch.criteria.fechaBaja']}"
												onclick="$('uF:fechaBajaDesdeCriteria').value=''" />
											<script type="text/javascript">
												$('uF:fechaBajaDesdeCriteria').disabled=true;
											</script>

											<h:outputLabel value=" #{common['common.hasta']} "/>
											<t:inputCalendar id="fechaBajaHastaCriteria"
												value="#{usuarioListAction.form.fechaBajaHastaCriteria}"
												renderAsPopup="true" popupDateFormat="dd/MM/yyyy"
												renderPopupButtonAsImage="true"
												popupTodayString="#{common['common.calendar.hoyEs']}"
												popupWeekString="#{common['common.calendar.wK']}"
												popupButtonImageUrl="../../images/calendar_icon.gif"
												disabled="false" styleClass="dateDisabled" popupButtonStyle="margin:1px"/>
											<h:graphicImage border="0" value="/images/icon_limpiar.gif"
												alt="#{msg['usuarioSearch.criteria.fechaBaja']}"
												onclick="$('uF:fechaBajaHastaCriteria').value=''" />
											<script type="text/javascript">
												$('uF:fechaBajaHastaCriteria').disabled=true;
											</script>
										</t:panelGroup>

										<h:outputLabel for="nombre"
											value=" #{msg['usuarioSearch.criteria.nombre']}" />
										<h:inputText styleClass="text medium" id="nombre"
											value="#{usuarioListAction.form.nombre}" required="false"
											maxlength="255" />

										<h:outputLabel for="apellido1"
											value="#{msg['usuarioSearch.criteria.apellido1']}" />
										<h:inputText styleClass="text medium" id="apellido1"
											value="#{usuarioListAction.form.apellido1}" required="false"
											maxlength="255" />

										<h:outputLabel for="apellido2"
											value="#{msg['usuarioSearch.criteria.apellido2']}" />
										<h:inputText styleClass="text medium" id="apellido2"
											value="#{usuarioListAction.form.apellido2}" required="false"
											maxlength="255" />

										<h:outputText value=""/>
										<h:outputText value=""/>

										<h:outputLabel for="email"
											value="#{msg['usuarioSearch.criteria.email']}" />
										<h:inputText styleClass="text medium" id="email"
											value="#{usuarioListAction.form.email}" required="false"
											maxlength="255" />

										<h:outputLabel for="telefono"
											value="#{msg['usuarioSearch.criteria.fijo']}" />
										<h:inputText styleClass="text medium" id="telefono"
											value="#{usuarioListAction.form.telefono}" required="false"
											maxlength="255" />

										<h:outputLabel for="movil"
											value="#{msg['usuarioSearch.criteria.movil']}" />
										<h:inputText styleClass="text medium" id="movil"
											value="#{usuarioListAction.form.movil}" required="false"
											maxlength="255" />

										<h:outputLabel for="fax"
											value="#{msg['usuarioSearch.criteria.fax']}" />
										<h:inputText styleClass="text medium" id="fax"
											value="#{usuarioListAction.form.fax}" required="false"
											maxlength="255" />

										<h:outputLabel for="bibliotecas"
											value="#{msg['usuarioSearch.criteria.bibliotecas']}" />
										<t:panelGroup colspan="3">
											<h:selectOneRadio id="radios"
												value="#{usuarioListAction.form.busqueda}" styleClass="nobg"
												layout="pageDirection" onclick="limpiarSeleccionados()">
												<f:selectItems
													value="#{usuarioListAction.form.buscarPorBiblioteca}" />
											</h:selectOneRadio>

											<t:panelGroup>
												<t:panelGroup>
													<h:inputText styleClass="cajaTexto"
														id="codigoBiblioteca"
														value="#{usuarioListAction.form.codigoBiblioteca}"
														required="false" maxlength="255" size="30"/>
													<h:inputHidden value="#{contextoAction.codigoBiblioteca}" id="codigoBibliotecaOculto"/>
													<h:outputLink onclick="$('uF:codigoBiblioteca').value=$F('uF:codigoBibliotecaOculto');" id="recuperarContextoCodigo" value="#">
														<h:graphicImage border="0" value="/images/ico_recuperar.gif" alt="#{common['button.contexto']}" title="#{common['button.contexto']}"/>
													</h:outputLink>
												</t:panelGroup>
												<t:panelGroup>
													<h:inputText styleClass="cajaTexto" size="30" id="descripcion"
														value="#{usuarioListAction.form.descripcionBiblioteca}" required="false"
														maxlength="80" />
												</t:panelGroup>
												<t:panelGroup>
													<ui:include src="/common/tree/arbolBibliotecasSuggest.xhtml">
														<ui:param name="beanTreeData" value="#{treePermisosListarUsuariosAction}" />
														<ui:param name="beanNodoClick" value="#{usuarioListAction}" />
														<ui:param name="readOnly" value="false" />
														<ui:param name="form" value="uF" />
														<ui:param name="page" value="/librae-adminconfig/pages/usuario/list.html" />
													</ui:include>
												</t:panelGroup>
											</t:panelGroup>
										</t:panelGroup>

										<h:outputLabel for="roles"
											value="#{msg['usuarioSearch.criteria.roles']}" />
										<t:panelGroup colspan="3">
											<h:selectManyListbox id="roles"
												value="#{usuarioListAction.form.idRoles}" size="13" styleClass="margenDerecho">
												<f:selectItem itemValue="0"
													itemLabel="#{common['select.seleccione']}" />
												<f:selectItems value="#{comboAction.roles}" />
											</h:selectManyListbox>
										</t:panelGroup>

										<f:facet name="footer">
											<h:panelGroup>
												<h:commandLink styleClass="boton_rojo"
													title="#{common['button.clean']}"
													action="#{usuarioListAction.limpiar}">
													<span><h:outputText
														value="#{common['button.clean']}" /></span>
												</h:commandLink>
												<h:commandLink action="#{usuarioListAction.buscar}" id="buscar"
													styleClass="boton" title="#{common['button.search']}"
													onclick="$('uF:fechaBajaDesdeCriteria').disabled=false;$('uF:fechaBajaHastaCriteria').disabled=false;$('uF:fechaAltaDesdeCriteria').disabled=false;$('uF:fechaAltaHastaCriteria').disabled=false;$('uF:codigoBibliotecaOculto').value=$F('uF:codigoBiblioteca');">
													<span><h:outputText
														value="#{common['button.search']}" /></span>
												</h:commandLink>
												<t:saveState id="saveRoles" value="#{comboAction.roles}" />
												<t:saveState id="saveTiposIdentificacion"
													value="#{comboAction.tiposIdentificacion}" />
											</h:panelGroup>
										</f:facet>
									</t:panelGrid>
								</t:div>
							</t:div>
								<h:inputHidden value="#{contextoAction.codigoUsuario}" id="codigoUsuario"/>
								<librae:subTabListado
									binding="#{usuarioListAction.form.subTabResultados}">

									<t:div styleClass="listado">

										<t:panelGrid columns="2" styleClass="botones">
											<t:panelGroup>
												<span class="btn_barra"> <t:selectBooleanCheckbox
													styleClass="btn_st" forceId="true" id="selectAll"
													value="#{usuarioListAction.selectedAll}"
													onclick="actualizarSeleccionTodos(this, 'usuarios', 'selectAllPage');" />
												<em id="btn_st1"><h:outputText
													value="#{common['button.selectAll']}" /></em> <em
													style="display: none;" id="btn_st2"><h:outputText
													value="#{common['button.deselectAll']}" /></em> </span>

												<t:commandLink action="add" id="add" immediate="true"
													styleClass="btn_barra" rendered="#{!usuarioListAction.orbeActivo}"
													visibleOnUserRole="ADM_Mantenimiento_Usuario" title="#{common['button.add']}">
													<span><h:outputText value="#{common['button.add']}" /></span>
												</t:commandLink>

												<t:commandLink action="#{asignarPerfilesUsuarioAction.init}"
													id="asignar" immediate="true" styleClass="btn_barra"
													visibleOnUserRole="ADM_Asignar_Usuario" title="#{common['breadcrumb.asignarRolesUnUsuario']}">
													<span><h:outputText
														value="#{msg['usuarioSearch.button.asignar']}" /></span>
													<f:param name="idListado" value="usuarios" />
												</t:commandLink>

											</t:panelGroup>
											<t:panelGroup styleClass="botonfinal">
												<h:commandButton action="#{usuarioListAction.generarPdf}" immediate="true" styleClass="imprimir" title="#{common['button.pdf']}" image="/images/pdf_icon.gif" alt="#{common['button.pdf']}" />
												<h:commandButton action="#{usuarioListAction.generarExcel}" immediate="true" styleClass="imprimir" title="#{common['button.excel']}" image="/images/hoja_calculo_icon.gif" alt="#{common['button.excel']}" />
												<t:selectOneMenu id="factorPaginacion"
													styleClass="combo_paginacion" onchange="document.getElementById('_viewRoot:status.start').style.display='';return oamSubmitForm('uF','uF:cambiarPaginacion');"
													value="#{usuarioListAction.pageSize}">
													<f:selectItem itemValue="10" itemLabel="10" />
													<f:selectItem itemValue="20" itemLabel="20" />
													<f:selectItem itemValue="30" itemLabel="30" />
													<f:selectItem itemValue="50" itemLabel="50" />
													<!-- f:selectItem itemValue="-1" itemLabel="Todos" / -->
												</t:selectOneMenu>
												<t:commandLink action="#{usuarioListAction.modificarPageSize}"
													id="cambiarPaginacion" style="display:none;">
													<h:outputText value="." />
												</t:commandLink>
											</t:panelGroup>
										</t:panelGrid>

										<ui:include src="/pages/usuario/include/dataTable.xhtml">
											<ui:param name="bean" value="#{usuarioListAction}" />
										</ui:include>

										<ui:include src="/common/paginatorAjax.xhtml">
											<ui:param name="bean" value="#{usuarioListAction}" />
											<ui:param name="idListado" value="usuarios" />
										</ui:include>
									</t:div>
								</librae:subTabListado>
						</librae:tab>
					</librae:tabbedPage>
				</t:div>
				<head>
					<script type="text/javascript">
						//<![CDATA[
						if (($('uF:radios:0').checked) || ($('uF:radios:1').checked)) {
							arbolActivo=false;
						}

						function limpiarSeleccionados() {
							if (($('uF:radios:0').checked) || ($('uF:radios:1').checked)) {
								arbolActivo=false;
							} else if ($('uF:radios:2').checked) {
								arbolActivo=true;
							}
						}
 						//]]>
 					</script>
				</head>
			</h:form>

			<librae:windowMessages bean="#{usuarioListAction}" borrar="true" />

		</f:view>
	</ui:define>
</ui:composition>

</html>
